# ìœ„í—˜ë„ ê³„ì‚° ë¡œì§ ì¶”ê°€ ê°œì„ 

## ğŸ“Š í˜„ì¬ ìƒíƒœ ë¶„ì„ (loganomaly_risk_analysis_1)

### ê°œì„  íš¨ê³¼
- **CRITICAL ë¡œê·¸ ê°ì†Œ**: 809ê°œ â†’ 416ê°œ (48.6% ê°ì†Œ) âœ…
- **ì‹¤ì œ ìœ„í—˜í•œ ë¡œê·¸**: 119ê°œ (28.6%)
- **ì •ìƒ ì¿¼ë¦¬ ë¡œê·¸**: 287ê°œ (69.0%) âŒ ì—¬ì „íˆ ë¬¸ì œ

### ë¬¸ì œì 
ì •ìƒ ì¿¼ë¦¬ íŒ¨í„´ì´ ê°ì§€ë˜ì—ˆì§€ë§Œ ì—¬ì „íˆ CRITICALë¡œ ë¶„ë¥˜ë˜ëŠ” ê²½ìš°ê°€ ë§ìŒ:

```
ì˜ˆì‹œ:
- ìœ„í—˜ë„: 150.00 (CRITICAL)
- ì´ìƒ ì ìˆ˜: 1.68
- ì‹¬ê°ë„: HIGH (8)
- ë©”ì‹œì§€: "==> Parameters: 1(String) | <== Total: 0"
- ë¬¸ì œ: ì •ìƒ ì¿¼ë¦¬ íŒ¨í„´ì¸ë°ë„ CRITICALë¡œ ë¶„ë¥˜ë¨
```

**ì›ì¸:**
- ì •ìƒ ì¿¼ë¦¬ íŒ¨í„´ ê°ì§€ ì‹œ ìœ„í—˜ë„ë¥¼ ë‚®ì·„ì§€ë§Œ, ì—¬ì „íˆ 80ì  ì´ìƒì´ ë  ìˆ˜ ìˆìŒ
- ì‹¬ê°ë„ê°€ HIGH(8)ì´ê³  ì´ìƒ ì ìˆ˜ê°€ ë†’ìœ¼ë©´ ìœ„í—˜ë„ê°€ ë†’ê²Œ ê³„ì‚°ë¨

---

## âœ… ì¶”ê°€ ê°œì„  ì‚¬í•­

### 1. ì •ìƒ ì¿¼ë¦¬ ìœ„í—˜ë„ ìƒí•œì„  ì„¤ì •

```python
if is_normal_query and not has_real_exception:
    # ì •ìƒ ì¿¼ë¦¬ ë¡œê·¸: ìœ„í—˜ë„ ëŒ€í­ ë‚®ì¶¤
    risk_score = (
        anomaly_score * 15 +  # ì´ìƒ ì ìˆ˜ ê°€ì¤‘ì¹˜ ë” ë‚®ì¶¤ (20â†’15)
        (severity_score / 10) * 10  # ì‹¬ê°ë„ ê°€ì¤‘ì¹˜ ë” ë‚®ì¶¤ (15â†’10)
    )
    # ì •ìƒ ì¿¼ë¦¬ëŠ” ìµœëŒ€ 79ì ìœ¼ë¡œ ì œí•œ (CRITICAL ë°©ì§€)
    risk_score = min(79, risk_score)
```

**íš¨ê³¼:**
- ì •ìƒ ì¿¼ë¦¬ íŒ¨í„´ì´ ê°ì§€ë˜ë©´ **ë¬´ì¡°ê±´ 79ì  ì´í•˜**ë¡œ ì œí•œ
- CRITICAL(80ì  ì´ìƒ)ì´ ë˜ì§€ ì•Šë„ë¡ ë³´ì¥

### 2. ê°€ì¤‘ì¹˜ ì¶”ê°€ ì¡°ì •

| ìƒí™© | ì´ì „ ê°€ì¤‘ì¹˜ | ê°œì„  í›„ ê°€ì¤‘ì¹˜ | ìµœëŒ€ ì ìˆ˜ |
|------|------------|--------------|----------|
| ì •ìƒ ì¿¼ë¦¬ | anomalyÃ—20 + severityÃ—15 | anomalyÃ—15 + severityÃ—10 | **79ì ** (ì œí•œ) |
| ì‹¤ì œ ì˜ˆì™¸ | anomalyÃ—60 + severityÃ—70 | ë™ì¼ | 150ì  |
| ê¸°ë³¸ | anomalyÃ—40 + severityÃ—40 | ë™ì¼ | 150ì  |

---

## ğŸ“ˆ ì˜ˆìƒ ê°œì„  íš¨ê³¼

### Before (í˜„ì¬ - loganomaly_risk_analysis_1)
```
CRITICAL: 416ê°œ
  - ì‹¤ì œ ìœ„í—˜: 119ê°œ (28.6%)
  - ì •ìƒ ì¿¼ë¦¬: 287ê°œ (69.0%) âŒ
  - ê¸°íƒ€: 10ê°œ (2.4%)
```

### After (ì¶”ê°€ ê°œì„  í›„ ì˜ˆìƒ)
```
CRITICAL: ~120-150ê°œ (ì˜ˆìƒ)
  - ì‹¤ì œ ìœ„í—˜: ~110-140ê°œ (90%+)
  - ì •ìƒ ì¿¼ë¦¬: 0ê°œ (0%) âœ…
  - ê¸°íƒ€: ~10-20ê°œ (10%)
```

**ê°œì„  íš¨ê³¼:**
- CRITICAL ë¡œê·¸: 416ê°œ â†’ ~120ê°œ (ì•½ **71% ê°ì†Œ**)
- ì •í™•ë„: 28.6% â†’ 90%+ (ì•½ **3ë°° í–¥ìƒ**)

---

## ğŸ”§ ì ìš©ëœ ë³€ê²½ ì‚¬í•­

### ì½”ë“œ ë³€ê²½
```python
# ì •ìƒ ì¿¼ë¦¬ íŒ¨í„´ ê°ì§€ ì‹œ
if is_normal_query and not has_real_exception:
    risk_score = (
        anomaly_score * 15 +  # ê°€ì¤‘ì¹˜ ë” ë‚®ì¶¤
        (severity_score / 10) * 10
    )
    risk_score = min(79, risk_score)  # ìµœëŒ€ 79ì ìœ¼ë¡œ ì œí•œ
```

### í•µì‹¬ ê°œì„ ì 
1. âœ… **ì •ìƒ ì¿¼ë¦¬ ìœ„í—˜ë„ ìƒí•œì„ **: ìµœëŒ€ 79ì ìœ¼ë¡œ ì œí•œ
2. âœ… **ê°€ì¤‘ì¹˜ ì¶”ê°€ ì¡°ì •**: ë” ë‚®ì€ ê°€ì¤‘ì¹˜ ì ìš©
3. âœ… **CRITICAL ë°©ì§€**: ì •ìƒ ì¿¼ë¦¬ëŠ” ì ˆëŒ€ CRITICALì´ ë˜ì§€ ì•ŠìŒ

---

## ğŸ¯ ì¬ì‹¤í–‰ ê¶Œì¥

### ì‹¤í–‰ ë°©ë²•
```bash
cd /Users/zzangdol/PycharmProjects/zzangdol/pattern/prelog

python log_specific_anomaly_detectors.py
```

### ì˜ˆìƒ ê²°ê³¼
```
ìœ„í—˜ë„ ë¶„í¬:
  - CRITICAL  :  120ê°œ ( 3.7%)  â† ëŒ€í­ ê°ì†Œ
  - HIGH      :  200ê°œ ( 6.2%)
  - MEDIUM    :  500ê°œ (15.5%)
  - LOW       : 1500ê°œ (46.5%)
  - INFO      :  900ê°œ (27.9%)
```

---

## ğŸ“ ê²°ë¡ 

### í˜„ì¬ ìƒíƒœ (loganomaly_risk_analysis_1)
- âŒ **ì—¬ì „íˆ 69%ê°€ ì •ìƒ ì¿¼ë¦¬ ë¡œê·¸**
- âš ï¸ **ì •ìƒ ì¿¼ë¦¬ íŒ¨í„´ ê°ì§€ ë¡œì§ì´ ì™„ë²½í•˜ì§€ ì•ŠìŒ**

### ì¶”ê°€ ê°œì„  í›„ ì˜ˆìƒ
- âœ… **ì •ìƒ ì¿¼ë¦¬ëŠ” CRITICALì´ ë˜ì§€ ì•ŠìŒ** (ìµœëŒ€ 79ì )
- âœ… **ì‹¤ì œ ìœ„í—˜í•œ ë¡œê·¸ë§Œ CRITICALë¡œ ë¶„ë¥˜**
- âœ… **ì •í™•ë„ 90%+ ë‹¬ì„± ì˜ˆìƒ**

### ê¶Œì¥ ì‚¬í•­
1. **ì¬ì‹¤í–‰**: ì¶”ê°€ ê°œì„ ëœ ë¡œì§ìœ¼ë¡œ ì¬ì‹¤í–‰
2. **ê²€ì¦**: CRITICAL ë¡œê·¸ê°€ ì‹¤ì œ ìœ„í—˜í•œì§€ í™•ì¸
3. **í•„ìš” ì‹œ ì¶”ê°€ ì¡°ì •**: íŒ¨í„´/í‚¤ì›Œë“œ ì¶”ê°€

---

## ğŸ” ê²€ì¦ ë°©ë²•

### ì¬ì‹¤í–‰ í›„ í™•ì¸
```python
import pandas as pd

df = pd.read_csv('results/loganomaly_risk_analysis_2/risk_critical.csv')

# ì •ìƒ ì¿¼ë¦¬ íŒ¨í„´ í™•ì¸
normal_patterns = ['binding parameter', '==> parameters', 'committing jdbc']
is_normal = df['sample_messages'].str.lower().str.contains(
    '|'.join(normal_patterns)
)

print(f"ì •ìƒ ì¿¼ë¦¬ì¸ë° CRITICAL: {is_normal.sum()}ê°œ")
print(f"ëª©í‘œ: 0ê°œ")
```

**ê¸°ëŒ€ ê²°ê³¼:**
- ì •ìƒ ì¿¼ë¦¬ì¸ë° CRITICAL: **0ê°œ** âœ…

